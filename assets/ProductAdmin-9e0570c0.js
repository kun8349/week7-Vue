import{m as k,P as M,D as C}from"./PaginationView-398dbfd5.js";import{_ as y,o as d,c as n,a as t,B as r,C as c,F as f,z as U,E as V,I as L,b as _,w as D,r as h,A as b,G as I,H as N}from"./index-45e5e989.js";import"./_commonjsHelpers-28e086c5.js";const A={props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{status:{},modal:"",tempProduct:{}}},emits:["update-product"],mixins:[k],watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}}},E={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},B={class:"modal-dialog modal-lg"},T={class:"modal-content"},F={class:"modal-header bg-dark"},S={class:"modal-title text-white",id:"productModalLabel"},O={key:0},R={key:1},j=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},G={class:"row"},z={class:"col-4"},q={class:"mb-4"},J=t("label",{class:"form-label"},"主要圖片",-1),K={key:0},Q=["src"],W={key:0},X=t("label",{class:"form-label"},"圖片網址",-1),Y=["onUpdate:modelValue"],Z={key:0},$=["src"],tt={key:0},et={key:1},ot={class:"col-8"},st={class:"mb-3"},lt=t("label",{class:"form-label"},"產品名稱",-1),dt={class:"row"},nt={class:"col-6"},it={class:"mb-3"},rt=t("label",{class:"form-label"},"分類",-1),ct={class:"col-6"},at={class:"mb-3"},ut=t("label",{class:"form-label"},"單位",-1),pt={class:"col-6"},mt=t("label",{class:"form-label"},"原價",-1),_t={class:"col-6"},ht=t("label",{class:"form-label"},"售價",-1),bt=t("hr",null,null,-1),gt={class:"mb-3"},Pt=t("label",{class:"form-label"},"產品描述",-1),vt={class:"mb-3"},ft=t("label",{class:"form-label"},"說明內容",-1),yt={class:"mb-3"},Ut=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),xt={class:"modal-footer"},wt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(l,e,u,p,o,a){return d(),n("div",E,[t("div",B,[t("div",T,[t("div",F,[t("h5",S,[u.isNew===!0?(d(),n("span",O,"新增產品")):(d(),n("span",R,"編輯產品"))]),j]),t("div",H,[t("div",G,[t("div",z,[t("div",q,[J,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s)},null,512),[[c,o.tempProduct.imageUrl]]),o.tempProduct.imageUrl?(d(),n("img",{key:1,src:o.tempProduct.imageUrl,alt:"主要圖片",class:"img-fluid mt-3"},null,8,Q)):(d(),n("span",K))]),Array.isArray(o.tempProduct.imagesUrl)?(d(),n("div",W,[(d(!0),n(f,null,U(o.tempProduct.imagesUrl,(s,m)=>(d(),n("div",{class:"mb-4",key:m+"img"},[X,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":v=>o.tempProduct.imagesUrl[m]=v},null,8,Y),[[c,o.tempProduct.imagesUrl[m]]]),s?(d(),n("img",{key:1,src:s,alt:"次要圖片",class:"img-fluid mt-3"},null,8,$)):(d(),n("span",Z))]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(d(),n("div",tt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm w-100",onClick:e[1]||(e[1]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(d(),n("div",et,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:e[2]||(e[2]=()=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):V("",!0)]),t("div",ot,[t("div",st,[lt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入產品名稱","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.title=s)},null,512),[[c,o.tempProduct.title]])]),t("div",dt,[t("div",nt,[t("div",it,[rt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.category=s)},null,512),[[c,o.tempProduct.category]])])]),t("div",ct,[t("div",at,[ut,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.unit=s)},null,512),[[c,o.tempProduct.unit]])])]),t("div",pt,[t("div",null,[mt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.origin_price=s)},null,512),[[c,o.tempProduct.origin_price,void 0,{number:!0}]])])]),t("div",_t,[t("div",null,[ht,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.price=s)},null,512),[[c,o.tempProduct.price,void 0,{number:!0}]])])])]),bt,t("div",gt,[Pt,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.description=s)},`\r
                            `,512),[[c,o.tempProduct.description]])]),t("div",vt,[ft,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.content=s)},`\r
                            `,512),[[c,o.tempProduct.content]])]),t("div",null,[t("div",yt,[r(t("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[L,o.tempProduct.is_enabled]]),Ut])])])])]),t("div",xt,[wt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=s=>l.$emit("update-product",o.tempProduct))}," 確認 ")])])])],512)}const Mt=y(A,[["render",kt]]);const{VITE_URL:g,VITE_PATH:P}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kevin-jiang",BASE_URL:"/week7-Vue/",MODE:"production",DEV:!1,PROD:!0},Ct={data(){return{isLoading:!0,fullPage:!1,color:"#BBFFFF",isNew:!0,productList:[],tempProduct:{imagesUrl:[]},currentPage:1,pages:{}}},components:{ProductModal:Mt,Pagination:M,DelModal:C},methods:{getProducts(l=1){this.isLoading=!0,this.currentPage=l,this.$http.get(`${g}api/${P}/admin/products/?page=${l}`).then(e=>{this.productList=e.data.products,this.pages=e.data.pagination,this.isLoading=!1}).catch(e=>{alert(e.response.data.message)})},createImg(){this.product.imagesUrl=[],this.product.imagesUrl.push("")},openModal(l,e){l==="new"?(this.isNew=!0,this.tempProduct={imagesUrl:[]}):(this.tempProduct={...e},this.isNew=!1),this.$refs.productModal.openModal()},updateProduct(l){this.tempProduct=l;let e=`${g}/api/${P}/admin/product`,u="post";this.isNew||(e=`${g}/api/${P}/admin/product/${this.tempProduct.id}`,u="put"),this.$http[u](e,{data:this.tempProduct}).then(p=>{alert(p.data.message),this.$refs.productModal.hideModal(),this.getProducts()}).catch(p=>{alert(p.response.data.message)})},openDelProductModal(l){this.tempProduct={...l},this.$refs.delModal.openModal()},delProduct(){this.$http.delete(`${g}api/${P}/admin/product/${this.tempProduct.id}`).then(()=>{this.$refs.delModal.hideModal(),this.getProducts(this.currentPage),alert("成功刪除產品")}).catch(l=>{console.log(l)})}},mounted(){this.getProducts()}},x=l=>(I("data-v-ab161deb"),l=l(),N(),l),Vt=x(()=>t("div",{id:"load"},[t("div",null,"G"),t("div",null,"N"),t("div",null,"I"),t("div",null,"D"),t("div",null,"A"),t("div",null,"O"),t("div",null,"L")],-1)),Lt={class:"my-3 text-end"},Dt={class:"table"},It=x(()=>t("thead",null,[t("tr",null,[t("th",{width:"100px"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120px"},"原價"),t("th",{width:"120px"},"售價"),t("th",{width:"100px"},"是否啟用"),t("th",{width:"120px"},"編輯")])],-1)),Nt={class:"table-group-divider"},At={key:0,class:"text-success"},Et={key:1},Bt={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},Tt=["onClick"],Ft=["onClick"],St={class:"d-flex justify-content-center"};function Ot(l,e,u,p,o,a){const s=h("AppLoading"),m=h("Pagination"),v=h("ProductModal"),w=h("DelModal");return d(),n(f,null,[t("div",null,[_(s,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=i=>o.isLoading=i)},{default:D(()=>[Vt]),_:1},8,["active"])]),t("div",Lt,[t("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=()=>a.openModal("new"))},"建立新產品")]),t("table",Dt,[It,t("tbody",Nt,[(d(!0),n(f,null,U(o.productList,i=>(d(),n("tr",{key:i.id+"後台產品列表"},[t("td",null,b(i.category),1),t("td",null,b(i.title),1),t("td",null,b(i.origin_price),1),t("td",null,b(i.price),1),t("td",null,[i.is_enabled?(d(),n("span",At,"啟用")):(d(),n("span",Et,"未啟用"))]),t("td",null,[t("div",Bt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>a.openModal("edit",i)},"編輯",8,Tt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>a.openDelProductModal(i)}," 刪除 ",8,Ft)])])]))),128))])]),t("div",St,[_(m,{pages:o.pages,onEmitPages:a.getProducts},null,8,["pages","onEmitPages"])]),_(v,{onUpdateProduct:a.updateProduct,product:o.tempProduct,isNew:o.isNew,ref:"productModal"},null,8,["onUpdateProduct","product","isNew"]),_(w,{item:o.tempProduct,onDelItem:a.delProduct,ref:"delModal"},null,8,["item","onDelItem"])],64)}const Gt=y(Ct,[["render",Ot],["__scopeId","data-v-ab161deb"]]);export{Gt as default};
