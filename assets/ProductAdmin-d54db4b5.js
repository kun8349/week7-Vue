import{m as M,P as C,D as V}from"./PaginationView-39a2cc7a.js";import{_ as U,o as l,c as n,a as t,B as r,C as c,F as v,z as w,E as L,I as B,b as _,w as D,r as h,A as b,G as I,H as N}from"./index-806c1ca4.js";import{S as m}from"./sweetalert2.all-b5115aad.js";const A={props:{product:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{status:{},modal:"",tempProduct:{}}},emits:["update-product"],mixins:[M],watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}}},E={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},S={class:"modal-dialog modal-lg"},T={class:"modal-content"},F={class:"modal-header bg-dark"},O={class:"modal-title text-white",id:"productModalLabel"},R={key:0},j={key:1},H=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},z={class:"row"},q={class:"col-4"},J={class:"mb-4"},K=t("label",{class:"form-label"},"主要圖片",-1),Q={key:0},W=["src"],X={key:0},Y=t("label",{class:"form-label"},"圖片網址",-1),Z=["onUpdate:modelValue"],$={key:0},tt=["src"],et={key:0},ot={key:1},st={class:"col-8"},lt={class:"mb-3"},nt=t("label",{class:"form-label"},"產品名稱",-1),dt={class:"row"},it={class:"col-6"},rt={class:"mb-3"},ct=t("label",{class:"form-label"},"分類",-1),at={class:"col-6"},ut={class:"mb-3"},pt=t("label",{class:"form-label"},"單位",-1),mt={class:"col-6"},_t=t("label",{class:"form-label"},"原價",-1),ht={class:"col-6"},bt=t("label",{class:"form-label"},"售價",-1),ft=t("hr",null,null,-1),Pt={class:"mb-3"},gt=t("label",{class:"form-label"},"產品描述",-1),vt={class:"mb-3"},yt=t("label",{class:"form-label"},"說明內容",-1),Ut={class:"mb-3"},wt=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),xt={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Mt(d,e,a,y,o,u){return l(),n("div",E,[t("div",S,[t("div",T,[t("div",F,[t("h5",O,[a.isNew===!0?(l(),n("span",R,"新增產品")):(l(),n("span",j,"編輯產品"))]),H]),t("div",G,[t("div",z,[t("div",q,[t("div",J,[K,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s)},null,512),[[c,o.tempProduct.imageUrl]]),o.tempProduct.imageUrl?(l(),n("img",{key:1,src:o.tempProduct.imageUrl,alt:"主要圖片",class:"img-fluid mt-3"},null,8,W)):(l(),n("span",Q))]),Array.isArray(o.tempProduct.imagesUrl)?(l(),n("div",X,[(l(!0),n(v,null,w(o.tempProduct.imagesUrl,(s,p)=>(l(),n("div",{class:"mb-4",key:p+"img"},[Y,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片網址","onUpdate:modelValue":g=>o.tempProduct.imagesUrl[p]=g},null,8,Z),[[c,o.tempProduct.imagesUrl[p]]]),s?(l(),n("img",{key:1,src:s,alt:"次要圖片",class:"img-fluid mt-3"},null,8,tt)):(l(),n("span",$))]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(l(),n("div",et,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm w-100",onClick:e[1]||(e[1]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(l(),n("div",ot,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:e[2]||(e[2]=()=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):L("",!0)]),t("div",st,[t("div",lt,[nt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入產品名稱","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.title=s)},null,512),[[c,o.tempProduct.title]])]),t("div",dt,[t("div",it,[t("div",rt,[ct,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.category=s)},null,512),[[c,o.tempProduct.category]])])]),t("div",at,[t("div",ut,[pt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.unit=s)},null,512),[[c,o.tempProduct.unit]])])]),t("div",mt,[t("div",null,[_t,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.origin_price=s)},null,512),[[c,o.tempProduct.origin_price,void 0,{number:!0}]])])]),t("div",ht,[t("div",null,[bt,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.price=s)},null,512),[[c,o.tempProduct.price,void 0,{number:!0}]])])])]),ft,t("div",Pt,[gt,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.description=s)},`\r
                            `,512),[[c,o.tempProduct.description]])]),t("div",vt,[yt,r(t("textarea",{class:"form-control",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.content=s)},`\r
                            `,512),[[c,o.tempProduct.content]])]),t("div",null,[t("div",Ut,[r(t("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[B,o.tempProduct.is_enabled]]),wt])])])])]),t("div",xt,[kt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=s=>d.$emit("update-product",o.tempProduct))}," 確認 ")])])])],512)}const Ct=U(A,[["render",Mt]]);const{VITE_URL:f,VITE_PATH:P}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kevin-jiang",BASE_URL:"/week7-Vue/",MODE:"production",DEV:!1,PROD:!0},Vt={data(){return{isLoading:!0,fullPage:!1,color:"#BBFFFF",isNew:!0,productList:[],tempProduct:{imagesUrl:[]},currentPage:1,pages:{}}},components:{ProductModal:Ct,Pagination:C,DelModal:V},methods:{getProducts(d=1){this.isLoading=!0,this.currentPage=d,this.$http.get(`${f}api/${P}/admin/products/?page=${d}`).then(e=>{this.productList=e.data.products,this.pages=e.data.pagination,this.isLoading=!1}).catch(e=>{alert(e.response.data.message)})},createImg(){this.product.imagesUrl=[],this.product.imagesUrl.push("")},openModal(d,e){d==="new"?(this.isNew=!0,this.tempProduct={imagesUrl:[]}):(this.tempProduct={...e},this.isNew=!1),this.$refs.productModal.openModal()},updateProduct(d){this.tempProduct=d;let e=`${f}/api/${P}/admin/product`,a="post";this.isNew||(e=`${f}/api/${P}/admin/product/${this.tempProduct.id}`,a="put"),this.$http[a](e,{data:this.tempProduct}).then(y=>{a==="post"?m.fire({position:"top-end",icon:"success",title:"產品建立成功d(`･∀･)b",showConfirmButton:!1,timer:1500,toast:!0}):m.fire({position:"top-end",icon:"success",title:"產品更新成功d(`･∀･)b",showConfirmButton:!1,timer:1500,toast:!0}),this.$refs.productModal.hideModal(),this.getProducts()}).catch(()=>{m.fire({icon:"success",title:"處理失敗٩(ŏ﹏ŏ、)۶",showConfirmButton:!1,timer:1500})})},openDelProductModal(d){this.tempProduct={...d},this.$refs.delModal.openModal()},delProduct(){this.$http.delete(`${f}api/${P}/admin/product/${this.tempProduct.id}`).then(()=>{this.$refs.delModal.hideModal(),this.getProducts(this.currentPage),m.fire({position:"top-end",icon:"success",title:"成功刪除單一產品d(`･∀･)b",showConfirmButton:!1,timer:1500,toast:!0})}).catch(()=>{m.fire({icon:"success",title:"刪除單一品項失敗٩(ŏ﹏ŏ、)۶",showConfirmButton:!1,timer:1500})})}},mounted(){this.getProducts()}},x=d=>(I("data-v-3df40cd8"),d=d(),N(),d),Lt=x(()=>t("div",{id:"load"},[t("div",null,"G"),t("div",null,"N"),t("div",null,"I"),t("div",null,"D"),t("div",null,"A"),t("div",null,"O"),t("div",null,"L")],-1)),Bt={class:"my-3 text-end"},Dt={class:"table"},It=x(()=>t("thead",null,[t("tr",null,[t("th",{width:"100px"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120px"},"原價"),t("th",{width:"120px"},"售價"),t("th",{width:"100px"},"是否啟用"),t("th",{width:"120px"},"編輯")])],-1)),Nt={class:"table-group-divider"},At={key:0,class:"text-success"},Et={key:1},St={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},Tt=["onClick"],Ft=["onClick"],Ot={class:"d-flex justify-content-center"};function Rt(d,e,a,y,o,u){const s=h("AppLoading"),p=h("Pagination"),g=h("ProductModal"),k=h("DelModal");return l(),n(v,null,[t("div",null,[_(s,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=i=>o.isLoading=i)},{default:D(()=>[Lt]),_:1},8,["active"])]),t("div",Bt,[t("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=()=>u.openModal("new"))},"建立新產品")]),t("table",Dt,[It,t("tbody",Nt,[(l(!0),n(v,null,w(o.productList,i=>(l(),n("tr",{key:i.id+"後台產品列表"},[t("td",null,b(i.category),1),t("td",null,b(i.title),1),t("td",null,b(i.origin_price),1),t("td",null,b(i.price),1),t("td",null,[i.is_enabled?(l(),n("span",At,"啟用")):(l(),n("span",Et,"未啟用"))]),t("td",null,[t("div",St,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>u.openModal("edit",i)},"編輯",8,Tt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>u.openDelProductModal(i)}," 刪除 ",8,Ft)])])]))),128))])]),t("div",Ot,[_(p,{pages:o.pages,onEmitPages:u.getProducts},null,8,["pages","onEmitPages"])]),_(g,{onUpdateProduct:u.updateProduct,product:o.tempProduct,isNew:o.isNew,ref:"productModal"},null,8,["onUpdateProduct","product","isNew"]),_(k,{item:o.tempProduct,onDelItem:u.delProduct,ref:"delModal"},null,8,["item","onDelItem"])],64)}const zt=U(Vt,[["render",Rt],["__scopeId","data-v-3df40cd8"]]);export{zt as default};
